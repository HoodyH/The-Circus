"use strict";(self.webpackChunkThe_Circus=self.webpackChunkThe_Circus||[]).push([[389],{5389:(Z,a,l)=>{l.r(a),l.d(a,{LiveModule:()=>L});var r=l(6895),u=l(8954),d=l(9833),t=l(8256),h=l(7139),p=l(4624),g=l(6613),m=l(892),v=l(4426),f=l(7093);function x(i,o){if(1&i&&(t.ynx(0),t._UZ(1,"img",5),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.currentFile.url,t.LSH)("alt",e.currentFile.id)}}function C(i,o){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"video",6,7),t.NdJ("playing",function(s){t.CHM(e);const c=t.oxw(2);return t.KtG(c.calculateVideoTime(s))}),t._UZ(3,"source",8),t._uU(4," Il tuo browser non supporta la visualizzazione dei video. "),t.qZA(),t.BQk()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("muted",!0),t.xp6(2),t.Q6J("src",e.currentFile.url,t.LSH)}}function _(i,o){if(1&i&&(t.TgZ(0,"p",9),t._uU(1,"Caricato da: "),t.TgZ(2,"strong"),t._uU(3),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(3),t.AsE("",e.currentFile.user.first_name," ",e.currentFile.user.last_name,"")}}function y(i,o){if(1&i&&(t.TgZ(0,"div",1)(1,"div",2)(2,"div",2),t.YNc(3,x,2,2,"ng-container",3),t.YNc(4,C,5,2,"ng-container",3),t.YNc(5,_,4,2,"p",4),t.qZA()()()),2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngIf","video/mp4"!==e.currentFile.type),t.xp6(1),t.Q6J("ngIf","video/mp4"===e.currentFile.type),t.xp6(1),t.Q6J("ngIf",e.currentFile)}}let P=(()=>{class i{constructor(){this.slidingTimeSeconds=10,this.slidingVideoMaxTimeSeconds=30,this.files=[],this.lastScrolledPhoto=new t.vpe}ngOnInit(){this.displayFile()}ngOnChanges(e){e.files&&e.files.currentValue&&e.files.currentValue.length&&!e.files.firstChange&&this.displayFile()}displayFile(){this.files&&this.files.length>0?(this.currentFile=this.files.pop(),this.setNextInteraction("video/mp4"!==this.currentFile.type?this.slidingTimeSeconds:this.slidingVideoMaxTimeSeconds)):(this.lastScrolledPhoto.emit(this.currentFile),this.setNextInteraction(this.slidingTimeSeconds))}calculateVideoTime(e){let n=Math.floor(e.target.duration);n>this.slidingTimeSeconds&&(n=this.slidingTimeSeconds),this.setNextInteraction(n)}setNextInteraction(e){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.displayFile()},1e3*e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-carousel"]],inputs:{slidingTimeSeconds:"slidingTimeSeconds",slidingVideoMaxTimeSeconds:"slidingVideoMaxTimeSeconds",files:"files"},outputs:{lastScrolledPhoto:"lastScrolledPhoto"},features:[t.TTD],decls:1,vars:1,consts:[["class","p-3",4,"ngIf"],[1,"p-3"],[1,""],[4,"ngIf"],["class","file-tag",4,"ngIf"],[1,"img-fluid",3,"src","alt"],["autoplay","","loop","",1,"video-fluid",3,"muted","playing"],["videoPlayer",""],["type","video/mp4",3,"src"],[1,"file-tag"]],template:function(e,n){1&e&&t.YNc(0,y,6,3,"div",0),2&e&&t.Q6J("ngIf",n.currentFile)},dependencies:[r.O5],styles:[".carousel-item[_ngcontent-%COMP%]{height:auto;max-height:50%}img[_ngcontent-%COMP%], video[_ngcontent-%COMP%]{max-height:60vh}.file-tag[_ngcontent-%COMP%]{position:relative;bottom:25px;border-radius:var(--border-radius);background-color:var(--primary-color);padding:.6em;color:#eee;width:-moz-fit-content;width:fit-content;margin:auto}"]}),i})();function S(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",4)(1,"app-carousel",5),t.NdJ("lastScrolledPhoto",function(s){t.CHM(e);const c=t.oxw();return t.KtG(c.getCaruselData(s))}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("files",e.files)}}function M(i,o){if(1&i&&(t.TgZ(0,"div",4),t._UZ(1,"app-poll-chart",6),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("results",e.currentPollResults)}}function T(i,o){if(1&i&&(t.TgZ(0,"div",4),t._UZ(1,"app-current-status",7),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("activities",e.event.activities)("eventDate",e.event.start_datetime)}}class b{constructor(){this.empty="empty",this.poll="poll",this.carusel="carusel"}}const O=[{path:"",component:(()=>{class i{constructor(e,n,s,c){this.eventService=e,this.galleryService=n,this.pollService=s,this.liveService=c,this.currentPollResults=[],this.currentLiveService=new b,this.currentLiveDisplay=this.currentLiveService.carusel,this.backgroundSubscription=null}ngOnInit(){this.eventService.getEvent().subscribe({next:e=>{this.event=e}}),this.getCaruselData(),this.pollService.getPoll().subscribe({next:e=>{this.polls=e}}),this.liveService.backgroundSubject.subscribe({next:e=>{this.background=e}}),this.backgroundSubscription=this.liveService.subscribeBackground()}ngOnDestroy(){this.backgroundSubscription&&this.backgroundSubscription.unsubscrive()}checkAction(){}getPollData(){this.pollService.getPoll().subscribe({next:e=>{for(const n of e)this.pollService.isActive(n.start_datetime,n.end_datetime)&&(this.currentPoll=n);this.currentPoll&&(this.currentPollResults=this.pollService.generateResults(this.currentPoll.votes))}})}getCaruselData(e){this.galleryService.getFiles().subscribe({next:n=>{const s=n.results;if(s&&e){const c=s.findIndex(F=>F.id===e.id);c>0&&(this.files=s.slice(0,c)),-1==c&&(this.files=s)}else this.files=s}})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h.y),t.Y36(p.j),t.Y36(g.X),t.Y36(m.k))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-live"]],decls:16,vars:5,consts:[[1,"vh-100","d-flex","align-items-center"],[1,"circles"],[1,"container"],["class","row",4,"ngIf"],[1,"row"],[1,"col","text-center","mx-auto",3,"files","lastScrolledPhoto"],[3,"results"],[3,"activities","eventDate"]],template:function(e,n){1&e&&(t.TgZ(0,"section",0)(1,"ul",1),t._UZ(2,"li")(3,"li")(4,"li")(5,"li")(6,"li")(7,"li")(8,"li")(9,"li")(10,"li")(11,"li"),t.qZA(),t.TgZ(12,"div",2),t.YNc(13,S,2,1,"div",3),t.YNc(14,M,2,1,"div",3),t.YNc(15,T,2,2,"div",3),t.qZA()()),2&e&&(t.Udp("background",n.background?n.background.color:"#eee"),t.xp6(13),t.Q6J("ngIf",n.currentLiveDisplay==n.currentLiveService.carusel),t.xp6(1),t.Q6J("ngIf",n.currentLiveDisplay==n.currentLiveService.poll),t.xp6(1),t.Q6J("ngIf",n.event))},dependencies:[r.O5,v.C,f.J,P],styles:[".area[_ngcontent-%COMP%]{background:#4e54c8;background:-webkit-linear-gradient(to left,#8f94fb,#4e54c8);width:100%;height:100vh}.circles[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden}.circles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:absolute;display:block;list-style:none;width:20px;height:20px;background:rgba(255,255,255,.3);animation:animate 25s linear infinite;bottom:-150px}.circles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(1){left:25%;width:80px;height:80px;animation-delay:0s}.circles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(2){left:10%;width:20px;height:20px;animation-delay:2s;animation-duration:12s}.circles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(3){left:70%;width:20px;height:20px;animation-delay:4s}.circles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(4){left:40%;width:60px;height:60px;animation-delay:0s;animation-duration:18s}.circles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(5){left:65%;width:20px;height:20px;animation-delay:0s}.circles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(6){left:75%;width:110px;height:110px;animation-delay:3s}.circles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(7){left:35%;width:150px;height:150px;animation-delay:7s}.circles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(8){left:50%;width:25px;height:25px;animation-delay:15s;animation-duration:45s}.circles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(9){left:20%;width:15px;height:15px;animation-delay:2s;animation-duration:35s}.circles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(10){left:85%;width:150px;height:150px;animation-delay:0s;animation-duration:11s}@keyframes animate{0%{transform:translateY(0) rotate(0);opacity:1;border-radius:0}to{transform:translateY(-1000px) rotate(720deg);opacity:0;border-radius:50%}}"]}),i})()}];let w=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[d.Bz.forChild(O),d.Bz]}),i})(),L=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[r.ez,u.O,w]}),i})()}}]);